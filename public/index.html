<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AdsPro AI - Google Ads Management</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
*{font-family:'Inter',sans-serif;box-sizing:border-box}
::-webkit-scrollbar{width:6px;height:6px}
::-webkit-scrollbar-track{background:#1e293b}
::-webkit-scrollbar-thumb{background:#475569;border-radius:3px}
::-webkit-scrollbar-thumb:hover{background:#64748b}
.glass{backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px)}
.nav-item.active{background:linear-gradient(135deg,#3b82f6,#8b5cf6);box-shadow:0 4px 15px rgba(59,130,246,0.4)}
.stat-card{transition:all 0.3s ease}
.stat-card:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(59,130,246,0.15)}
.table-row:hover{background:rgba(59,130,246,0.08)}
.tab-btn.active{background:linear-gradient(135deg,#3b82f6,#8b5cf6);color:white}
.tool-card{transition:all 0.2s ease}
.tool-card:hover{transform:scale(1.02);border-color:#3b82f6}
.tool-card.connected{border-color:#10b981}
.loading{position:relative;pointer-events:none;opacity:0.7}
.loading::after{content:'';position:absolute;top:50%;left:50%;width:20px;height:20px;margin:-10px 0 0 -10px;border:2px solid #3b82f6;border-top-color:transparent;border-radius:50%;animation:spin 0.8s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.8);z-index:100;align-items:center;justify-content:center}
.modal.active{display:flex}
</style>
</head>
<body class="bg-slate-900 text-white min-h-screen">

<!-- App Container -->
<div id="app">
<div class="flex">
<!-- Sidebar -->
<aside class="w-64 h-screen bg-slate-800/80 border-r border-slate-700/50 fixed left-0 top-0 glass z-50 flex flex-col">
<div class="p-5 border-b border-slate-700/50">
<div class="flex items-center gap-3">
<div class="w-11 h-11 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg shadow-blue-500/25">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
</div>
<div>
<h1 class="font-bold text-lg bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">AdsPro AI</h1>
<p class="text-xs text-slate-400">Google Ads Manager</p>
</div>
</div>
</div>

<!-- Account Selector -->
<div class="p-4 border-b border-slate-700/50">
<label class="text-xs text-slate-400 block mb-2">Ad Account</label>
<select id="accountSelector" onchange="switchAccount(this.value)" class="w-full px-3 py-2 rounded-lg text-sm bg-slate-700 border border-slate-600 focus:border-blue-500 focus:outline-none">
<option value="2841269298">284-126-9298</option>
<option value="4641032686">464-103-2686</option>
<option value="3385827193">338-582-7193</option>
</select>
</div>

<nav class="flex-1 p-4 space-y-1 overflow-y-auto">
<button onclick="showPage('dashboard')" class="nav-item active w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium transition-all" data-page="dashboard">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
Dashboard
</button>
<button onclick="showPage('campaigns')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all" data-page="campaigns">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/></svg>
Campaigns
</button>
<button onclick="showPage('keywords')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all" data-page="keywords">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"/></svg>
Keywords
</button>
<button onclick="showPage('ads')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all" data-page="ads">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
Ads
</button>

<div class="pt-4 mt-4 border-t border-slate-700/50">
<p class="text-xs text-slate-500 uppercase tracking-wider mb-3 px-4">Research Tools</p>
</div>

<button onclick="showPage('research')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all" data-page="research">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
Competitor Research
</button>
<button onclick="showPage('keyword-research')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all" data-page="keyword-research">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/></svg>
Keyword Research
</button>

<div class="pt-4 mt-4 border-t border-slate-700/50">
<p class="text-xs text-slate-500 uppercase tracking-wider mb-3 px-4">AI Tools</p>
</div>

<button onclick="showPage('ai-assistant')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all" data-page="ai-assistant">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/></svg>
AI Assistant
<span class="ml-auto px-2 py-0.5 rounded-full text-xs bg-purple-500/30 text-purple-300">New</span>
</button>

<button onclick="showPage('settings')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all" data-page="settings">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
Settings & API Keys
</button>
</nav>

<div class="p-4 border-t border-slate-700/50">
<div class="flex items-center gap-3 px-3 py-2">
<img id="userPicture" src="https://ui-avatars.com/api/?name=User&background=3b82f6&color=fff" class="w-9 h-9 rounded-full">
<div class="flex-1 min-w-0">
<p class="text-sm font-medium truncate" id="userName">User</p>
<p class="text-xs text-slate-400 truncate" id="userEmail">Loading...</p>
</div>
</div>
<a href="/auth/logout" class="mt-2 w-full flex items-center justify-center gap-2 px-4 py-2 rounded-xl text-sm font-medium text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/></svg>
Logout
</a>
</div>
</aside>

<!-- Main Content -->
<main class="flex-1 ml-64 min-h-screen">
<!-- Header -->
<header class="sticky top-0 z-40 bg-slate-900/90 border-b border-slate-700/50 glass">
<div class="px-6 py-4 flex items-center justify-between">
<div>
<h2 class="text-xl font-bold" id="pageTitle">Dashboard</h2>
<p class="text-sm text-slate-400" id="pageSubtitle">Overview of your Google Ads performance</p>
</div>
<div class="flex items-center gap-3">
<select id="dateRange" onchange="handleDateChange()" class="px-3 py-2 rounded-lg text-sm bg-slate-800 border border-slate-700 focus:border-blue-500 focus:outline-none">
<option value="today">Today</option>
<option value="yesterday">Yesterday</option>
<option value="last7">Last 7 Days</option>
<option value="last30" selected>Last 30 Days</option>
<option value="last90">Last 90 Days</option>
</select>
<button onclick="refreshData()" class="p-2 rounded-lg bg-slate-800 border border-slate-700 hover:bg-slate-700 transition-colors" title="Refresh">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg>
</button>
</div>
</div>
</header>

<!-- Error/Success Messages -->
<div id="alertContainer" class="px-6 pt-4"></div>

<!-- Page Content -->
<div class="p-6">
<!-- Dashboard Page -->
<div id="page-dashboard" class="page-content">
<!-- KPI Cards -->
<div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6">
<div class="stat-card bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<div class="flex items-center gap-2 mb-2">
<div class="p-2 rounded-lg bg-blue-500/20"><svg class="w-4 h-4 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg></div>
</div>
<p class="text-xs text-slate-400 uppercase">Impressions</p>
<p class="text-xl font-bold" id="kpiImpressions">-</p>
</div>
<div class="stat-card bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<div class="flex items-center gap-2 mb-2">
<div class="p-2 rounded-lg bg-purple-500/20"><svg class="w-4 h-4 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"/></svg></div>
</div>
<p class="text-xs text-slate-400 uppercase">Clicks</p>
<p class="text-xl font-bold" id="kpiClicks">-</p>
</div>
<div class="stat-card bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<div class="flex items-center gap-2 mb-2">
<div class="p-2 rounded-lg bg-emerald-500/20"><svg class="w-4 h-4 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg></div>
</div>
<p class="text-xs text-slate-400 uppercase">Conversions</p>
<p class="text-xl font-bold" id="kpiConversions">-</p>
</div>
<div class="stat-card bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<div class="flex items-center gap-2 mb-2">
<div class="p-2 rounded-lg bg-amber-500/20"><svg class="w-4 h-4 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg></div>
</div>
<p class="text-xs text-slate-400 uppercase">Cost</p>
<p class="text-xl font-bold" id="kpiCost">-</p>
</div>
<div class="stat-card bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<div class="flex items-center gap-2 mb-2">
<div class="p-2 rounded-lg bg-rose-500/20"><svg class="w-4 h-4 text-rose-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/></svg></div>
</div>
<p class="text-xs text-slate-400 uppercase">Revenue</p>
<p class="text-xl font-bold" id="kpiRevenue">-</p>
</div>
<div class="stat-card bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<div class="flex items-center gap-2 mb-2">
<div class="p-2 rounded-lg bg-cyan-500/20"><svg class="w-4 h-4 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/></svg></div>
</div>
<p class="text-xs text-slate-400 uppercase">ROAS</p>
<p class="text-xl font-bold" id="kpiRoas">-</p>
</div>
</div>

<!-- Charts Row -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl p-5">
<h3 class="font-semibold mb-4">Performance Trend</h3>
<canvas id="performanceChart" height="130"></canvas>
</div>
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl p-5">
<h3 class="font-semibold mb-4">Device Distribution</h3>
<canvas id="deviceChart" height="130"></canvas>
</div>
</div>

<!-- Quick Actions -->
<div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
<button onclick="showPage('research')" class="p-4 rounded-xl bg-gradient-to-br from-blue-500/20 to-purple-500/20 border border-blue-500/30 hover:border-blue-500/50 transition-all text-left">
<svg class="w-8 h-8 text-blue-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
<h4 class="font-semibold">Competitor Research</h4>
<p class="text-xs text-slate-400 mt-1">Spy on competitor ads & keywords</p>
</button>
<button onclick="showPage('keyword-research')" class="p-4 rounded-xl bg-gradient-to-br from-emerald-500/20 to-teal-500/20 border border-emerald-500/30 hover:border-emerald-500/50 transition-all text-left">
<svg class="w-8 h-8 text-emerald-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"/></svg>
<h4 class="font-semibold">Keyword Research</h4>
<p class="text-xs text-slate-400 mt-1">Find profitable keywords</p>
</button>
<button onclick="showPage('ai-assistant')" class="p-4 rounded-xl bg-gradient-to-br from-purple-500/20 to-pink-500/20 border border-purple-500/30 hover:border-purple-500/50 transition-all text-left">
<svg class="w-8 h-8 text-purple-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/></svg>
<h4 class="font-semibold">AI Assistant</h4>
<p class="text-xs text-slate-400 mt-1">Create campaigns with AI</p>
</button>
<button onclick="openModal('createCampaign')" class="p-4 rounded-xl bg-gradient-to-br from-amber-500/20 to-orange-500/20 border border-amber-500/30 hover:border-amber-500/50 transition-all text-left">
<svg class="w-8 h-8 text-amber-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
<h4 class="font-semibold">New Campaign</h4>
<p class="text-xs text-slate-400 mt-1">Create a new ad campaign</p>
</button>
</div>

<!-- Campaigns Table -->
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl overflow-hidden">
<div class="p-4 border-b border-slate-700/50 flex items-center justify-between">
<h3 class="font-semibold">Top Campaigns</h3>
<button onclick="showPage('campaigns')" class="text-sm text-blue-400 hover:text-blue-300">View All →</button>
</div>
<div class="overflow-x-auto">
<table class="w-full text-sm">
<thead><tr class="text-xs uppercase text-slate-400 bg-slate-800/80">
<th class="text-left p-4">Campaign</th><th class="text-left p-4">Status</th><th class="text-left p-4">Type</th>
<th class="text-right p-4">Impr</th><th class="text-right p-4">Clicks</th><th class="text-right p-4">Conv</th>
<th class="text-right p-4">Cost</th><th class="text-right p-4">ROAS</th>
</tr></thead>
<tbody id="dashboardCampaigns"></tbody>
</table>
</div>
</div>
</div>

<!-- Campaigns Page -->
<div id="page-campaigns" class="page-content hidden">
<div class="flex items-center justify-between mb-6">
<div class="flex gap-2">
<button class="px-4 py-2 rounded-lg text-sm font-medium bg-blue-500 hover:bg-blue-600 transition-colors" onclick="openModal('createCampaign')">+ New Campaign</button>
<button class="px-4 py-2 rounded-lg text-sm font-medium bg-slate-700 hover:bg-slate-600 transition-colors">Bulk Actions</button>
</div>
<input type="text" placeholder="Search campaigns..." class="px-4 py-2 rounded-lg text-sm bg-slate-800 border border-slate-700 w-64 focus:outline-none focus:border-blue-500">
</div>
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl overflow-hidden">
<div class="overflow-x-auto">
<table class="w-full text-sm">
<thead><tr class="text-xs uppercase text-slate-400 bg-slate-800/80">
<th class="p-4"><input type="checkbox"></th>
<th class="text-left p-4">Campaign</th><th class="text-left p-4">Status</th><th class="text-left p-4">Type</th><th class="text-left p-4">Strategy</th>
<th class="text-right p-4">Budget</th><th class="text-right p-4">Impr</th><th class="text-right p-4">Clicks</th>
<th class="text-right p-4">CTR</th><th class="text-right p-4">Conv</th><th class="text-right p-4">Cost</th><th class="text-right p-4">CPA</th>
</tr></thead>
<tbody id="campaignsTable"></tbody>
</table>
</div>
</div>
</div>

<!-- Keywords Page -->
<div id="page-keywords" class="page-content hidden">
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl overflow-hidden">
<div class="p-4 border-b border-slate-700/50 flex items-center justify-between">
<h3 class="font-semibold">Keywords Performance</h3>
<button class="px-4 py-2 rounded-lg text-sm font-medium bg-emerald-500/20 text-emerald-400 hover:bg-emerald-500/30 transition-colors">Export</button>
</div>
<div class="overflow-x-auto max-h-[600px] overflow-y-auto">
<table class="w-full text-sm">
<thead class="sticky top-0 bg-slate-800"><tr class="text-xs uppercase text-slate-400">
<th class="text-left p-4">Keyword</th><th class="text-left p-4">Match</th><th class="text-left p-4">Status</th><th class="text-center p-4">QS</th>
<th class="text-right p-4">Impr</th><th class="text-right p-4">Clicks</th><th class="text-right p-4">CTR</th>
<th class="text-right p-4">Conv</th><th class="text-right p-4">Cost</th><th class="text-right p-4">CPA</th>
</tr></thead>
<tbody id="keywordsTable"></tbody>
</table>
</div>
</div>
</div>

<!-- Ads Page -->
<div id="page-ads" class="page-content hidden">
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="adsContainer"></div>
</div>

<!-- Competitor Research Page -->
<div id="page-research" class="page-content hidden">
<!-- Tool Connections -->
<div class="mb-6">
<div class="flex items-center justify-between mb-4">
<h3 class="font-semibold">Research Tools</h3>
<button onclick="openModal('apiSettings')" class="text-sm text-blue-400 hover:text-blue-300 flex items-center gap-1">
<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
Configure APIs
</button>
</div>
<div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3" id="toolCards"></div>
</div>

<!-- Competitor Analysis -->
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl p-5 mb-6">
<h3 class="font-semibold mb-4">Analyze Competitor</h3>
<div class="flex gap-4">
<div class="flex-1 relative">
<input type="text" id="competitorUrl" placeholder="Enter competitor domain (e.g., spectrum.com)" class="w-full pl-12 pr-4 py-3 rounded-xl text-sm bg-slate-700 border border-slate-600 placeholder-slate-500 focus:outline-none focus:border-blue-500">
<svg class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/></svg>
</div>
<button onclick="analyzeCompetitor()" id="analyzeBtn" class="px-6 py-3 rounded-xl text-sm font-medium bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 transition-all flex items-center gap-2">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
Analyze
</button>
</div>
<div class="flex flex-wrap gap-2 mt-3">
<span class="text-xs text-slate-400">Try:</span>
<button onclick="document.getElementById('competitorUrl').value='spectrum.com';analyzeCompetitor()" class="px-3 py-1 rounded-full text-xs bg-slate-700 hover:bg-slate-600">spectrum.com</button>
<button onclick="document.getElementById('competitorUrl').value='xfinity.com';analyzeCompetitor()" class="px-3 py-1 rounded-full text-xs bg-slate-700 hover:bg-slate-600">xfinity.com</button>
<button onclick="document.getElementById('competitorUrl').value='att.com';analyzeCompetitor()" class="px-3 py-1 rounded-full text-xs bg-slate-700 hover:bg-slate-600">att.com</button>
</div>
</div>

<!-- Results -->
<div id="competitorResults"></div>
</div>

<!-- Keyword Research Page -->
<div id="page-keyword-research" class="page-content hidden">
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl p-5 mb-6">
<h3 class="font-semibold mb-4">Find Keywords</h3>
<div class="flex gap-4">
<div class="flex-1 relative">
<input type="text" id="keywordInput" placeholder="Enter seed keyword (e.g., home internet)" class="w-full pl-12 pr-4 py-3 rounded-xl text-sm bg-slate-700 border border-slate-600 placeholder-slate-500 focus:outline-none focus:border-blue-500">
<svg class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"/></svg>
</div>
<select id="keywordCountry" class="px-4 py-3 rounded-xl text-sm bg-slate-700 border border-slate-600">
<option value="us">United States</option>
<option value="uk">United Kingdom</option>
<option value="ca">Canada</option>
<option value="au">Australia</option>
</select>
<button onclick="searchKeywords()" id="searchKwBtn" class="px-6 py-3 rounded-xl text-sm font-medium bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700 transition-all flex items-center gap-2">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
Research
</button>
</div>
</div>
<div id="keywordResults"></div>
</div>

<!-- AI Assistant Page -->
<div id="page-ai-assistant" class="page-content hidden">
<div class="max-w-4xl mx-auto">
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl overflow-hidden">
<div class="p-4 border-b border-slate-700/50 flex items-center gap-3">
<div class="w-10 h-10 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
</div>
<div>
<h3 class="font-semibold">AI Campaign Assistant</h3>
<p class="text-xs text-slate-400">Powered by Claude AI</p>
</div>
</div>
<div id="chatMessages" class="h-96 overflow-y-auto p-4 space-y-4">
<div class="flex gap-3">
<div class="w-8 h-8 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center flex-shrink-0">
<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
</div>
<div class="bg-slate-700/50 rounded-xl p-4 max-w-lg">
<p class="text-sm">Hello! I'm your AI Campaign Assistant. I can help you:</p>
<ul class="text-sm mt-2 space-y-1 text-slate-300">
<li>• Create new campaigns with optimized settings</li>
<li>• Generate ad copy and headlines</li>
<li>• Find profitable keywords</li>
<li>• Analyze competitor strategies</li>
<li>• Optimize bids and budgets</li>
</ul>
<p class="text-sm mt-2">What would you like to do today?</p>
</div>
</div>
</div>
<div class="p-4 border-t border-slate-700/50">
<div class="flex gap-3">
<input type="text" id="chatInput" placeholder="Ask me to create a campaign, find keywords, or analyze competitors..." class="flex-1 px-4 py-3 rounded-xl text-sm bg-slate-700 border border-slate-600 placeholder-slate-500 focus:outline-none focus:border-purple-500" onkeypress="if(event.key==='Enter')sendChat()">
<button onclick="sendChat()" class="px-5 py-3 rounded-xl text-sm font-medium bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 transition-all">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/></svg>
</button>
</div>
<div class="flex gap-2 mt-3">
<button onclick="setChat('Create a search campaign for home internet in California')" class="px-3 py-1.5 rounded-lg text-xs bg-slate-700 hover:bg-slate-600">Create Campaign</button>
<button onclick="setChat('Find keywords for fiber internet services')" class="px-3 py-1.5 rounded-lg text-xs bg-slate-700 hover:bg-slate-600">Find Keywords</button>
<button onclick="setChat('Analyze spectrum.com competitor ads')" class="px-3 py-1.5 rounded-lg text-xs bg-slate-700 hover:bg-slate-600">Analyze Competitor</button>
</div>
</div>
</div>
</div>
</div>

<!-- Settings Page -->
<div id="page-settings" class="page-content hidden">
<div class="max-w-3xl">
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl p-6 mb-6">
<h3 class="font-semibold mb-4">Google Ads API</h3>
<div class="grid gap-4">
<div>
<label class="text-sm text-slate-400 block mb-2">Developer Token</label>
<input type="password" value="••••••••••••••••" class="w-full px-4 py-2 rounded-lg text-sm bg-slate-700 border border-slate-600" readonly>
</div>
<div>
<label class="text-sm text-slate-400 block mb-2">Customer ID</label>
<input type="text" id="settingsCustomerId" value="" class="w-full px-4 py-2 rounded-lg text-sm bg-slate-700 border border-slate-600" readonly>
</div>
<p class="text-xs text-amber-400">⚠️ API Access: Test Account (waiting for Basic Access approval)</p>
</div>
</div>

<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl p-6 mb-6">
<h3 class="font-semibold mb-4">Research Tool API Keys</h3>
<p class="text-sm text-slate-400 mb-4">Connect your research tool accounts to get real data.</p>
<div class="space-y-4">
<div>
<label class="text-sm text-slate-400 block mb-2">SEMrush API Key</label>
<div class="flex gap-2">
<input type="password" id="semrushKey" placeholder="Enter your SEMrush API key" class="flex-1 px-4 py-2 rounded-lg text-sm bg-slate-700 border border-slate-600 focus:outline-none focus:border-blue-500">
<button onclick="saveApiKey('semrush')" class="px-4 py-2 rounded-lg text-sm font-medium bg-blue-500 hover:bg-blue-600">Save</button>
</div>
<p class="text-xs text-slate-500 mt-1">Get your API key from SEMrush → My Profile → API</p>
</div>
<div>
<label class="text-sm text-slate-400 block mb-2">DataForSEO API Credentials</label>
<div class="flex gap-2">
<input type="text" id="dataforseLogin" placeholder="Login" class="flex-1 px-4 py-2 rounded-lg text-sm bg-slate-700 border border-slate-600 focus:outline-none focus:border-blue-500">
<input type="password" id="dataforsePassword" placeholder="Password" class="flex-1 px-4 py-2 rounded-lg text-sm bg-slate-700 border border-slate-600 focus:outline-none focus:border-blue-500">
<button onclick="saveApiKey('dataforseo')" class="px-4 py-2 rounded-lg text-sm font-medium bg-blue-500 hover:bg-blue-600">Save</button>
</div>
<p class="text-xs text-slate-500 mt-1">Free tier available at dataforseo.com - good alternative to expensive tools</p>
</div>
<div>
<label class="text-sm text-slate-400 block mb-2">SerpApi Key (Google SERP Data)</label>
<div class="flex gap-2">
<input type="password" id="serpApiKey" placeholder="Enter your SerpApi key" class="flex-1 px-4 py-2 rounded-lg text-sm bg-slate-700 border border-slate-600 focus:outline-none focus:border-blue-500">
<button onclick="saveApiKey('serpapi')" class="px-4 py-2 rounded-lg text-sm font-medium bg-blue-500 hover:bg-blue-600">Save</button>
</div>
<p class="text-xs text-slate-500 mt-1">100 free searches/month at serpapi.com</p>
</div>
</div>
</div>

<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl p-6">
<h3 class="font-semibold mb-4">Claude AI API</h3>
<div>
<label class="text-sm text-slate-400 block mb-2">Anthropic API Key</label>
<div class="flex gap-2">
<input type="password" id="claudeApiKey" placeholder="Enter your Claude API key (sk-ant-...)" class="flex-1 px-4 py-2 rounded-lg text-sm bg-slate-700 border border-slate-600 focus:outline-none focus:border-blue-500">
<button onclick="saveApiKey('claude')" class="px-4 py-2 rounded-lg text-sm font-medium bg-purple-500 hover:bg-purple-600">Save</button>
</div>
<p class="text-xs text-slate-500 mt-1">Required for AI Assistant. Get from console.anthropic.com</p>
</div>
</div>
</div>
</div>

</div>
</main>
</div>
</div>

<!-- Modals -->
<div id="modal-createCampaign" class="modal">
<div class="bg-slate-800 border border-slate-700 rounded-2xl p-6 max-w-lg w-full mx-4">
<div class="flex items-center justify-between mb-4">
<h3 class="text-lg font-semibold">Create New Campaign</h3>
<button onclick="closeModal('createCampaign')" class="p-1 rounded-lg hover:bg-slate-700">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
</button>
</div>
<div class="space-y-4">
<div>
<label class="text-sm text-slate-400 block mb-2">Campaign Name</label>
<input type="text" placeholder="e.g., Home Internet - California" class="w-full px-4 py-2 rounded-lg text-sm bg-slate-700 border border-slate-600 focus:outline-none focus:border-blue-500">
</div>
<div>
<label class="text-sm text-slate-400 block mb-2">Campaign Type</label>
<select class="w-full px-4 py-2 rounded-lg text-sm bg-slate-700 border border-slate-600">
<option>Search</option>
<option>Display</option>
<option>Video</option>
<option>Shopping</option>
<option>Performance Max</option>
</select>
</div>
<div>
<label class="text-sm text-slate-400 block mb-2">Daily Budget ($)</label>
<input type="number" placeholder="50" class="w-full px-4 py-2 rounded-lg text-sm bg-slate-700 border border-slate-600 focus:outline-none focus:border-blue-500">
</div>
<div class="flex gap-3 mt-6">
<button onclick="closeModal('createCampaign')" class="flex-1 py-2 rounded-lg text-sm font-medium bg-slate-700 hover:bg-slate-600">Cancel</button>
<button class="flex-1 py-2 rounded-lg text-sm font-medium bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700">Create Campaign</button>
</div>
</div>
</div>
</div>

<script>
// ═══════════════════════════════════════════════════════════
// STATE & CONFIG
// ═══════════════════════════════════════════════════════════
let currentPage = 'dashboard';
let currentAccount = '2841269298';
let performanceChart = null;
let deviceChart = null;

// API Keys stored in localStorage
const getApiKey = (name) => localStorage.getItem(`apiKey_${name}`) || '';
const setApiKey = (name, value) => localStorage.setItem(`apiKey_${name}`, value);

// Research tools config
const researchTools = [
{id:'semrush',name:'SEMrush',color:'orange',status:()=>getApiKey('semrush')?'connected':'disconnected'},
{id:'dataforseo',name:'DataForSEO',color:'blue',status:()=>getApiKey('dataforseo')?'connected':'disconnected'},
{id:'serpapi',name:'SerpApi',color:'green',status:()=>getApiKey('serpapi')?'connected':'disconnected'},
{id:'google',name:'Google KW',color:'red',status:()=>'connected'},
{id:'spyfu',name:'SpyFu',color:'emerald',status:()=>'coming'},
{id:'ahrefs',name:'Ahrefs',color:'purple',status:()=>'coming'},
];

// ═══════════════════════════════════════════════════════════
// FORMATTING HELPERS
// ═══════════════════════════════════════════════════════════
const fmt = n => {
if (n === null || n === undefined || isNaN(n)) return '-';
if (n >= 1e6) return (n/1e6).toFixed(1)+'M';
if (n >= 1e3) return (n/1e3).toFixed(1)+'K';
return n.toLocaleString();
};
const fmtC = n => {
if (n === null || n === undefined || isNaN(n)) return '-';
return '$'+n.toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2});
};
const fmtPct = n => (n === null || n === undefined || isNaN(n)) ? '-' : (n*100).toFixed(2)+'%';

const statusBadge = s => {
const colors = {'ENABLED':'bg-emerald-500/20 text-emerald-400','PAUSED':'bg-amber-500/20 text-amber-400','Active':'bg-emerald-500/20 text-emerald-400'};
const label = s === 'ENABLED' ? 'Active' : s === 'PAUSED' ? 'Paused' : s;
return `<span class="px-2 py-0.5 rounded-full text-xs font-medium ${colors[s]||'bg-slate-500/20 text-slate-400'}">${label}</span>`;
};

// ═══════════════════════════════════════════════════════════
// NAVIGATION
// ═══════════════════════════════════════════════════════════
function showPage(page) {
currentPage = page;
document.querySelectorAll('.page-content').forEach(p => p.classList.add('hidden'));
document.getElementById('page-'+page)?.classList.remove('hidden');

document.querySelectorAll('.nav-item').forEach(n => {
n.classList.remove('active');
n.classList.add('text-slate-400');
});
document.querySelector(`[data-page="${page}"]`)?.classList.add('active');
document.querySelector(`[data-page="${page}"]`)?.classList.remove('text-slate-400');

const titles = {
dashboard: ['Dashboard', 'Overview of your Google Ads performance'],
campaigns: ['Campaigns', 'Manage your advertising campaigns'],
keywords: ['Keywords', 'View keyword performance'],
ads: ['Ads', 'Your ad creatives'],
research: ['Competitor Research', 'Analyze competitors and spy on their ads'],
'keyword-research': ['Keyword Research', 'Find profitable keywords for your campaigns'],
'ai-assistant': ['AI Assistant', 'Create and optimize campaigns with AI'],
settings: ['Settings', 'Configure API keys and integrations']
};
document.getElementById('pageTitle').textContent = titles[page]?.[0] || page;
document.getElementById('pageSubtitle').textContent = titles[page]?.[1] || '';

// Load page data
loadPageData(page);
}

function loadPageData(page) {
switch(page) {
case 'dashboard': loadDashboard(); break;
case 'campaigns': loadCampaigns(); break;
case 'keywords': loadKeywords(); break;
case 'ads': loadAds(); break;
case 'research': renderToolCards(); break;
case 'settings': loadSettings(); break;
}
}

// ═══════════════════════════════════════════════════════════
// API CALLS
// ═══════════════════════════════════════════════════════════
async function fetchAPI(endpoint) {
const range = document.getElementById('dateRange').value;
try {
const res = await fetch(`/api/${endpoint}?range=${range}`);
if (!res.ok) throw new Error('API error');
return await res.json();
} catch (e) {
console.error(e);
return { success: false, data: null };
}
}

async function checkAuth() {
try {
const res = await fetch('/auth/status');
const data = await res.json();
if (data.authenticated) {
document.getElementById('userName').textContent = data.user?.name || 'User';
document.getElementById('userEmail').textContent = data.user?.email || '';
if (data.user?.picture) document.getElementById('userPicture').src = data.user.picture;
loadDashboard();
} else {
window.location.href = '/auth/login';
}
} catch (e) {
console.error(e);
}
}

// ═══════════════════════════════════════════════════════════
// DASHBOARD
// ═══════════════════════════════════════════════════════════
async function loadDashboard() {
const data = await fetchAPI('dashboard');
if (data.success && data.data) {
const s = data.data.summary;
document.getElementById('kpiImpressions').textContent = fmt(s.impressions);
document.getElementById('kpiClicks').textContent = fmt(s.clicks);
document.getElementById('kpiConversions').textContent = fmt(s.conversions);
document.getElementById('kpiCost').textContent = fmtC(s.cost);
document.getElementById('kpiRevenue').textContent = fmtC(s.revenue);
document.getElementById('kpiRoas').textContent = s.roas ? s.roas.toFixed(2)+'x' : '-';

renderDashboardCampaigns(data.data.campaigns);
renderPerformanceChart(s.daily);
renderDeviceChart(data.data.devices);
}
}

function renderDashboardCampaigns(campaigns) {
const tbody = document.getElementById('dashboardCampaigns');
if (!campaigns?.length) {
tbody.innerHTML = '<tr><td colspan="8" class="p-8 text-center text-slate-400">No campaign data available. API access may be pending.</td></tr>';
return;
}
tbody.innerHTML = campaigns.slice(0,10).map(c => `
<tr class="table-row border-t border-slate-700/50">
<td class="p-4 font-medium">${c.name}</td>
<td class="p-4">${statusBadge(c.status)}</td>
<td class="p-4 text-slate-400">${c.type}</td>
<td class="p-4 text-right">${fmt(c.impressions)}</td>
<td class="p-4 text-right">${fmt(c.clicks)}</td>
<td class="p-4 text-right font-medium">${fmt(c.conversions)}</td>
<td class="p-4 text-right">${fmtC(c.cost)}</td>
<td class="p-4 text-right font-medium ${c.cost>0&&c.revenue/c.cost>=3?'text-emerald-400':c.cost>0&&c.revenue/c.cost>=2?'text-amber-400':'text-rose-400'}">${c.cost>0?(c.revenue/c.cost).toFixed(2)+'x':'-'}</td>
</tr>
`).join('');
}

function renderPerformanceChart(daily) {
const ctx = document.getElementById('performanceChart')?.getContext('2d');
if (!ctx) return;
if (performanceChart) performanceChart.destroy();

const labels = daily?.map(d => d.date).reverse() || [];
const data = daily?.map(d => d.conversions).reverse() || [];

performanceChart = new Chart(ctx, {
type: 'line',
data: { labels, datasets: [{label:'Conversions',data,borderColor:'#3b82f6',backgroundColor:'rgba(59,130,246,0.1)',fill:true,tension:0.4}] },
options: { responsive:true, plugins:{legend:{display:false}}, scales:{x:{grid:{color:'#334155'},ticks:{color:'#64748b'}},y:{grid:{color:'#334155'},ticks:{color:'#64748b'}}} }
});
}

function renderDeviceChart(devices) {
const ctx = document.getElementById('deviceChart')?.getContext('2d');
if (!ctx) return;
if (deviceChart) deviceChart.destroy();

const colors = ['#3b82f6','#8b5cf6','#ec4899','#f97316'];
deviceChart = new Chart(ctx, {
type: 'doughnut',
data: { labels: devices?.map(d=>d.device)||[], datasets: [{data:devices?.map(d=>d.impressions)||[],backgroundColor:colors,borderWidth:0}] },
options: { responsive:true, plugins:{legend:{position:'right',labels:{color:'#94a3b8'}}}, cutout:'60%' }
});
}

// ═══════════════════════════════════════════════════════════
// CAMPAIGNS, KEYWORDS, ADS
// ═══════════════════════════════════════════════════════════
async function loadCampaigns() {
const data = await fetchAPI('campaigns');
const tbody = document.getElementById('campaignsTable');
if (!data.data?.length) {
tbody.innerHTML = '<tr><td colspan="12" class="p-8 text-center text-slate-400">No campaigns found</td></tr>';
return;
}
tbody.innerHTML = data.data.map(c => `
<tr class="table-row border-t border-slate-700/50">
<td class="p-4"><input type="checkbox"></td>
<td class="p-4 font-medium">${c.name}</td>
<td class="p-4">${statusBadge(c.status)}</td>
<td class="p-4 text-slate-400">${c.type}</td>
<td class="p-4 text-slate-400">${c.bidStrategy}</td>
<td class="p-4 text-right">${fmtC(c.budget)}/d</td>
<td class="p-4 text-right">${fmt(c.impressions)}</td>
<td class="p-4 text-right">${fmt(c.clicks)}</td>
<td class="p-4 text-right">${fmtPct(c.ctr)}</td>
<td class="p-4 text-right font-medium">${fmt(c.conversions)}</td>
<td class="p-4 text-right">${fmtC(c.cost)}</td>
<td class="p-4 text-right">${fmtC(c.cpa)}</td>
</tr>
`).join('');
}

async function loadKeywords() {
const data = await fetchAPI('keywords');
const tbody = document.getElementById('keywordsTable');
if (!data.data?.length) {
tbody.innerHTML = '<tr><td colspan="10" class="p-8 text-center text-slate-400">No keywords found</td></tr>';
return;
}
tbody.innerHTML = data.data.map(k => `
<tr class="table-row border-t border-slate-700/50">
<td class="p-4 font-medium">${k.keyword}</td>
<td class="p-4"><span class="px-2 py-0.5 rounded text-xs ${k.matchType==='Exact'?'bg-blue-500/20 text-blue-400':k.matchType==='Phrase'?'bg-purple-500/20 text-purple-400':'bg-amber-500/20 text-amber-400'}">${k.matchType}</span></td>
<td class="p-4">${statusBadge(k.status)}</td>
<td class="p-4 text-center">${k.qualityScore?`<span class="font-bold ${k.qualityScore>=8?'text-emerald-400':k.qualityScore>=6?'text-amber-400':'text-rose-400'}">${k.qualityScore}/10</span>`:'<span class="text-slate-500">-</span>'}</td>
<td class="p-4 text-right">${fmt(k.impressions)}</td>
<td class="p-4 text-right">${fmt(k.clicks)}</td>
<td class="p-4 text-right">${fmtPct(k.ctr)}</td>
<td class="p-4 text-right font-medium">${fmt(k.conversions)}</td>
<td class="p-4 text-right">${fmtC(k.cost)}</td>
<td class="p-4 text-right">${fmtC(k.cpa)}</td>
</tr>
`).join('');
}

async function loadAds() {
const data = await fetchAPI('ads');
const container = document.getElementById('adsContainer');
if (!data.data?.length) {
container.innerHTML = '<p class="col-span-3 text-center text-slate-400 py-8">No ads found</p>';
return;
}
container.innerHTML = data.data.map(a => `
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<div class="flex items-center justify-between mb-2">
<span class="px-2 py-0.5 rounded text-xs bg-blue-500/20 text-blue-400">${a.type}</span>
${statusBadge(a.status)}
</div>
<div class="p-3 rounded-lg bg-slate-700/50 mb-3">
<p class="text-blue-400 text-sm font-medium">${a.headlines?.[0]||'No headline'}</p>
<p class="text-xs text-slate-400 mt-1">${a.descriptions?.[0]||'No description'}</p>
<p class="text-xs text-emerald-400 mt-1">${a.finalUrl?new URL(a.finalUrl).hostname:'-'}</p>
</div>
<div class="grid grid-cols-4 gap-2 text-center">
<div><p class="text-xs text-slate-500">Impr</p><p class="text-sm font-bold">${fmt(a.impressions)}</p></div>
<div><p class="text-xs text-slate-500">Clicks</p><p class="text-sm font-bold">${fmt(a.clicks)}</p></div>
<div><p class="text-xs text-slate-500">CTR</p><p class="text-sm font-bold">${fmtPct(a.ctr)}</p></div>
<div><p class="text-xs text-slate-500">Conv</p><p class="text-sm font-bold">${fmt(a.conversions)}</p></div>
</div>
</div>
`).join('');
}

// ═══════════════════════════════════════════════════════════
// RESEARCH TOOLS
// ═══════════════════════════════════════════════════════════
function renderToolCards() {
const container = document.getElementById('toolCards');
if (!container) return;
container.innerHTML = researchTools.map(t => {
const status = t.status();
const statusClass = status==='connected'?'border-emerald-500/50':'';
const statusLabel = status==='connected'?'<span class="px-2 py-0.5 rounded-full text-xs bg-emerald-500/20 text-emerald-400">Connected</span>':
status==='coming'?'<span class="px-2 py-0.5 rounded-full text-xs bg-slate-500/20 text-slate-400">Coming Soon</span>':
'<span class="px-2 py-0.5 rounded-full text-xs bg-blue-500/20 text-blue-400">Connect</span>';
return `
<div class="tool-card bg-slate-800/60 border ${statusClass} rounded-xl p-3 cursor-pointer" onclick="showPage('settings')">
<div class="flex items-center justify-between mb-2">
<div class="w-8 h-8 rounded-lg bg-${t.color}-500/20 flex items-center justify-center">
<span class="text-sm font-bold text-${t.color}-400">${t.name.charAt(0)}</span>
</div>
${statusLabel}
</div>
<h4 class="font-medium text-sm">${t.name}</h4>
</div>
`;
}).join('');
}

async function analyzeCompetitor() {
const domain = document.getElementById('competitorUrl').value.trim();
if (!domain) return showAlert('Please enter a competitor domain', 'error');

const btn = document.getElementById('analyzeBtn');
btn.classList.add('loading');

// Check for API keys
const hasApi = getApiKey('semrush') || getApiKey('dataforseo') || getApiKey('serpapi');

setTimeout(() => {
btn.classList.remove('loading');
if (!hasApi) {
document.getElementById('competitorResults').innerHTML = `
<div class="bg-amber-500/10 border border-amber-500/30 rounded-xl p-6 mb-6">
<h4 class="font-semibold text-amber-400 mb-2">⚠️ No Research API Connected</h4>
<p class="text-sm text-slate-300 mb-4">To get real competitor data, please connect at least one research tool API:</p>
<ul class="text-sm text-slate-400 space-y-1 mb-4">
<li>• <strong>DataForSEO</strong> - Best value, has free tier ($0.002/request)</li>
<li>• <strong>SEMrush</strong> - Premium data ($119+/mo)</li>
<li>• <strong>SerpApi</strong> - 100 free searches/month</li>
</ul>
<button onclick="showPage('settings')" class="px-4 py-2 rounded-lg text-sm font-medium bg-amber-500 text-black hover:bg-amber-400">Configure API Keys →</button>
</div>
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl p-6">
<h4 class="font-semibold mb-4">Demo Data for ${domain}</h4>
<p class="text-sm text-slate-400 mb-4">Below is sample data. Connect an API to see real metrics.</p>
${renderDemoCompetitorData(domain)}
</div>
`;
} else {
// Would make real API call here
document.getElementById('competitorResults').innerHTML = renderDemoCompetitorData(domain);
}
}, 1500);
}

function renderDemoCompetitorData(domain) {
return `
<div class="grid grid-cols-4 gap-4 mb-6">
<div class="text-center p-4 rounded-xl bg-slate-700/50">
<p class="text-2xl font-bold text-blue-400">$2.4M</p>
<p class="text-xs text-slate-400">Est. Ad Spend/mo</p>
</div>
<div class="text-center p-4 rounded-xl bg-slate-700/50">
<p class="text-2xl font-bold text-purple-400">12.5K</p>
<p class="text-xs text-slate-400">Paid Keywords</p>
</div>
<div class="text-center p-4 rounded-xl bg-slate-700/50">
<p class="text-2xl font-bold text-emerald-400">847</p>
<p class="text-xs text-slate-400">Active Ads</p>
</div>
<div class="text-center p-4 rounded-xl bg-slate-700/50">
<p class="text-2xl font-bold text-amber-400">8.2M</p>
<p class="text-xs text-slate-400">Monthly Traffic</p>
</div>
</div>
<div class="bg-slate-700/30 rounded-xl p-4">
<h5 class="font-medium mb-3">Top Paid Keywords</h5>
<table class="w-full text-sm">
<thead><tr class="text-xs text-slate-400"><th class="text-left pb-2">Keyword</th><th class="text-right pb-2">Volume</th><th class="text-right pb-2">CPC</th><th class="text-right pb-2">Position</th></tr></thead>
<tbody>
<tr class="border-t border-slate-700"><td class="py-2">home internet plans</td><td class="text-right">74K</td><td class="text-right">$8.45</td><td class="text-right">#1</td></tr>
<tr class="border-t border-slate-700"><td class="py-2">internet service near me</td><td class="text-right">49K</td><td class="text-right">$6.20</td><td class="text-right">#2</td></tr>
<tr class="border-t border-slate-700"><td class="py-2">fiber internet</td><td class="text-right">33K</td><td class="text-right">$11.30</td><td class="text-right">#1</td></tr>
<tr class="border-t border-slate-700"><td class="py-2">best internet provider</td><td class="text-right">27K</td><td class="text-right">$7.80</td><td class="text-right">#3</td></tr>
</tbody>
</table>
</div>
`;
}

function searchKeywords() {
const keyword = document.getElementById('keywordInput').value.trim();
if (!keyword) return showAlert('Please enter a seed keyword', 'error');

const btn = document.getElementById('searchKwBtn');
btn.classList.add('loading');

setTimeout(() => {
btn.classList.remove('loading');
const hasApi = getApiKey('semrush') || getApiKey('dataforseo') || getApiKey('serpapi');

if (!hasApi) {
document.getElementById('keywordResults').innerHTML = `
<div class="bg-amber-500/10 border border-amber-500/30 rounded-xl p-6 mb-6">
<h4 class="font-semibold text-amber-400 mb-2">⚠️ Connect a Research API for Real Data</h4>
<button onclick="showPage('settings')" class="px-4 py-2 rounded-lg text-sm font-medium bg-amber-500 text-black hover:bg-amber-400">Configure APIs →</button>
</div>
${renderDemoKeywordData(keyword)}
`;
} else {
document.getElementById('keywordResults').innerHTML = renderDemoKeywordData(keyword);
}
}, 1500);
}

function renderDemoKeywordData(seed) {
const keywords = [
{kw:seed,vol:33100,cpc:7.80,diff:72},
{kw:seed+' near me',vol:22200,cpc:8.50,diff:68},
{kw:'best '+seed,vol:18100,cpc:6.90,diff:58},
{kw:seed+' cost',vol:14800,cpc:5.40,diff:45},
{kw:'cheap '+seed,vol:9900,cpc:4.20,diff:52},
{kw:seed+' providers',vol:8100,cpc:7.20,diff:65},
{kw:seed+' reviews',vol:6600,cpc:3.80,diff:38},
{kw:seed+' deals',vol:5400,cpc:9.10,diff:71},
];
return `
<div class="grid grid-cols-4 gap-4 mb-6">
<div class="stat-card bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<p class="text-xs text-slate-400">Keywords Found</p>
<p class="text-2xl font-bold">${keywords.length}</p>
</div>
<div class="stat-card bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<p class="text-xs text-slate-400">Avg. Volume</p>
<p class="text-2xl font-bold">${fmt(keywords.reduce((a,k)=>a+k.vol,0)/keywords.length)}</p>
</div>
<div class="stat-card bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<p class="text-xs text-slate-400">Avg. CPC</p>
<p class="text-2xl font-bold">${fmtC(keywords.reduce((a,k)=>a+k.cpc,0)/keywords.length)}</p>
</div>
<div class="stat-card bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<p class="text-xs text-slate-400">Easy Wins</p>
<p class="text-2xl font-bold text-emerald-400">${keywords.filter(k=>k.diff<50).length}</p>
</div>
</div>
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl overflow-hidden">
<table class="w-full text-sm">
<thead><tr class="text-xs uppercase text-slate-400 bg-slate-800/80">
<th class="text-left p-4">Keyword</th><th class="text-right p-4">Volume</th><th class="text-right p-4">CPC</th><th class="p-4">Difficulty</th><th class="p-4">Action</th>
</tr></thead>
<tbody>
${keywords.map(k=>`
<tr class="border-t border-slate-700/50">
<td class="p-4 font-medium">${k.kw}</td>
<td class="p-4 text-right">${fmt(k.vol)}</td>
<td class="p-4 text-right">${fmtC(k.cpc)}</td>
<td class="p-4"><div class="flex items-center gap-2"><div class="flex-1 h-2 rounded-full bg-slate-700"><div class="h-full rounded-full ${k.diff>=70?'bg-rose-500':k.diff>=50?'bg-amber-500':'bg-emerald-500'}" style="width:${k.diff}%"></div></div><span class="text-xs">${k.diff}</span></div></td>
<td class="p-4 text-center"><button class="px-3 py-1 rounded-lg text-xs bg-blue-500/20 text-blue-400 hover:bg-blue-500/30">+ Add</button></td>
</tr>
`).join('')}
</tbody>
</table>
</div>
`;
}

// ═══════════════════════════════════════════════════════════
// AI CHAT
// ═══════════════════════════════════════════════════════════
function setChat(text) {
document.getElementById('chatInput').value = text;
}

function sendChat() {
const input = document.getElementById('chatInput');
const message = input.value.trim();
if (!message) return;

const container = document.getElementById('chatMessages');
container.innerHTML += `
<div class="flex gap-3 justify-end">
<div class="bg-blue-500/20 rounded-xl p-4 max-w-lg">
<p class="text-sm">${message}</p>
</div>
<div class="w-8 h-8 rounded-lg bg-slate-700 flex items-center justify-center flex-shrink-0">
<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
</div>
</div>
`;
input.value = '';
container.scrollTop = container.scrollHeight;

// Simulate AI response
setTimeout(() => {
const claudeKey = getApiKey('claude');
const response = claudeKey ? 
'I\'m analyzing your request. Let me help you with that...' :
'⚠️ Claude API key not configured. Please add your Anthropic API key in Settings to enable AI features.';

container.innerHTML += `
<div class="flex gap-3">
<div class="w-8 h-8 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center flex-shrink-0">
<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
</div>
<div class="bg-slate-700/50 rounded-xl p-4 max-w-lg">
<p class="text-sm">${response}</p>
${!claudeKey ? '<button onclick="showPage(\'settings\')" class="mt-2 px-3 py-1 rounded-lg text-xs bg-purple-500 hover:bg-purple-600">Go to Settings</button>' : ''}
</div>
</div>
`;
container.scrollTop = container.scrollHeight;
}, 1000);
}

// ═══════════════════════════════════════════════════════════
// SETTINGS
// ═══════════════════════════════════════════════════════════
function loadSettings() {
document.getElementById('settingsCustomerId')?.setAttribute('value', currentAccount);
document.getElementById('semrushKey').value = getApiKey('semrush');
document.getElementById('serpApiKey').value = getApiKey('serpapi');
document.getElementById('claudeApiKey').value = getApiKey('claude');
}

function saveApiKey(name) {
let value;
if (name === 'semrush') value = document.getElementById('semrushKey').value;
else if (name === 'dataforseo') value = document.getElementById('dataforseLogin').value + ':' + document.getElementById('dataforsePassword').value;
else if (name === 'serpapi') value = document.getElementById('serpApiKey').value;
else if (name === 'claude') value = document.getElementById('claudeApiKey').value;

if (value) {
setApiKey(name, value);
showAlert(`${name} API key saved!`, 'success');
renderToolCards();
}
}

// ═══════════════════════════════════════════════════════════
// UTILITIES
// ═══════════════════════════════════════════════════════════
function showAlert(message, type = 'info') {
const container = document.getElementById('alertContainer');
const colors = {success:'bg-emerald-500/20 border-emerald-500/50 text-emerald-400',error:'bg-rose-500/20 border-rose-500/50 text-rose-400',info:'bg-blue-500/20 border-blue-500/50 text-blue-400'};
container.innerHTML = `<div class="p-4 rounded-xl border ${colors[type]} mb-4">${message}</div>`;
setTimeout(() => container.innerHTML = '', 5000);
}

function openModal(name) {
document.getElementById('modal-'+name)?.classList.add('active');
}
function closeModal(name) {
document.getElementById('modal-'+name)?.classList.remove('active');
}

function switchAccount(accountId) {
currentAccount = accountId;
showAlert('Account switched. Note: Requires page reload to fetch new data.', 'info');
}

function handleDateChange() {
loadPageData(currentPage);
}

function refreshData() {
loadPageData(currentPage);
}

// ═══════════════════════════════════════════════════════════
// INIT
// ═══════════════════════════════════════════════════════════
document.addEventListener('DOMContentLoaded', checkAuth);
</script>
</body>
</html>
