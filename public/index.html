<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AdsPro AI - Google Ads Management</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
*{font-family:'Inter',sans-serif;box-sizing:border-box}
::-webkit-scrollbar{width:6px;height:6px}
::-webkit-scrollbar-track{background:#1e293b}
::-webkit-scrollbar-thumb{background:#475569;border-radius:3px}
::-webkit-scrollbar-thumb:hover{background:#64748b}
.glass{backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px)}
.nav-item.active{background:linear-gradient(135deg,#3b82f6,#8b5cf6);box-shadow:0 4px 15px rgba(59,130,246,0.4)}
.stat-card{transition:all 0.3s ease}
.stat-card:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(59,130,246,0.15)}
.table-row:hover{background:rgba(59,130,246,0.08)}
.tab-btn.active{background:linear-gradient(135deg,#3b82f6,#8b5cf6);color:white}
.tool-card{transition:all 0.2s ease}
.tool-card:hover{transform:scale(1.02);border-color:#3b82f6}
.tool-card.connected{border-color:#10b981}
.loading{position:relative;pointer-events:none;opacity:0.7}
.loading::after{content:'';position:absolute;top:50%;left:50%;width:20px;height:20px;margin:-10px 0 0 -10px;border:2px solid #3b82f6;border-top-color:transparent;border-radius:50%;animation:spin 0.8s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.8);z-index:100;align-items:center;justify-content:center}
.modal.active{display:flex}
.typing-indicator span{animation:typing 1.4s infinite ease-in-out}
.typing-indicator span:nth-child(2){animation-delay:0.2s}
.typing-indicator span:nth-child(3){animation-delay:0.4s}
@keyframes typing{0%,60%,100%{transform:translateY(0)}30%{transform:translateY(-4px)}}
.ai-message{white-space:pre-wrap}
.ai-message p{margin-bottom:0.75rem}
.ai-message ul,.ai-message ol{margin:0.5rem 0;padding-left:1.5rem}
.ai-message li{margin:0.25rem 0}
.ai-message strong{color:#60a5fa}
.ai-message code{background:#1e293b;padding:0.125rem 0.375rem;border-radius:4px;font-size:0.875em}
.ai-message pre{background:#1e293b;padding:1rem;border-radius:8px;overflow-x:auto;margin:0.75rem 0}
.ai-message table{width:100%;border-collapse:collapse;margin:0.75rem 0;font-size:0.875rem}
.ai-message th,.ai-message td{border:1px solid #334155;padding:0.5rem;text-align:left}
.ai-message th{background:#1e293b}
.ai-message h1,.ai-message h2,.ai-message h3{margin:1rem 0 0.5rem;font-weight:600}
.ai-message h1{font-size:1.25rem}
.ai-message h2{font-size:1.125rem}
.ai-message h3{font-size:1rem}
.chat-input:focus{box-shadow:0 0 0 3px rgba(139,92,246,0.3)}
.quick-action{transition:all 0.2s}
.quick-action:hover{background:#4f46e5;transform:scale(1.02)}
</style>
</head>
<body class="bg-slate-900 text-white min-h-screen">

<div id="app">
<div class="flex">
<!-- Sidebar -->
<aside class="w-64 h-screen bg-slate-800/80 border-r border-slate-700/50 fixed left-0 top-0 glass z-50 flex flex-col">
<div class="p-5 border-b border-slate-700/50">
<div class="flex items-center gap-3">
<div class="w-11 h-11 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg shadow-blue-500/25">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
</div>
<div>
<h1 class="font-bold text-lg bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">AdsPro AI</h1>
<p class="text-xs text-slate-400">Google Ads Manager</p>
</div>
</div>
</div>

<!-- Account Selector -->
<div class="p-4 border-b border-slate-700/50">
<label class="text-xs text-slate-400 block mb-2">Ad Account</label>
<select id="accountSelector" onchange="switchAccount(this.value)" class="w-full px-3 py-2 rounded-lg text-sm bg-slate-700 border border-slate-600 focus:border-blue-500 focus:outline-none">
<option value="2841269298">284-126-9298</option>
<option value="4641032686">464-103-2686</option>
<option value="3385827193">338-582-7193</option>
</select>
</div>

<nav class="flex-1 p-4 space-y-1 overflow-y-auto">
<button onclick="showPage('dashboard')" class="nav-item active w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium transition-all" data-page="dashboard">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
Dashboard
</button>
<button onclick="showPage('campaigns')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all" data-page="campaigns">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/></svg>
Campaigns
</button>
<button onclick="showPage('keywords')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all" data-page="keywords">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"/></svg>
Keywords
</button>
<button onclick="showPage('ads')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all" data-page="ads">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
Ads
</button>

<div class="pt-4 mt-4 border-t border-slate-700/50">
<p class="text-xs text-slate-500 uppercase tracking-wider mb-3 px-4">AI Tools</p>
</div>

<button onclick="showPage('ai-assistant')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all" data-page="ai-assistant">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/></svg>
AI Assistant
<span class="ml-auto px-2 py-0.5 rounded-full text-xs bg-gradient-to-r from-purple-500 to-pink-500">AI</span>
</button>

<div class="pt-4 mt-4 border-t border-slate-700/50">
<p class="text-xs text-slate-500 uppercase tracking-wider mb-3 px-4">Research</p>
</div>

<button onclick="showPage('research')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all" data-page="research">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
Competitor Research
</button>
<button onclick="showPage('keyword-research')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all" data-page="keyword-research">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/></svg>
Keyword Research
</button>

<button onclick="showPage('settings')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all mt-4" data-page="settings">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
Settings
</button>
</nav>

<div class="p-4 border-t border-slate-700/50">
<div class="flex items-center gap-3 px-3 py-2">
<img id="userPicture" src="https://ui-avatars.com/api/?name=User&background=3b82f6&color=fff" class="w-9 h-9 rounded-full">
<div class="flex-1 min-w-0">
<p class="text-sm font-medium truncate" id="userName">User</p>
<p class="text-xs text-slate-400 truncate" id="userEmail">Loading...</p>
</div>
</div>
<a href="/auth/logout" class="mt-2 w-full flex items-center justify-center gap-2 px-4 py-2 rounded-xl text-sm font-medium text-slate-400 hover:bg-slate-700/50 hover:text-white transition-all">
<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/></svg>
Logout
</a>
</div>
</aside>

<!-- Main Content -->
<main class="flex-1 ml-64 min-h-screen">
<!-- Header -->
<header class="sticky top-0 z-40 bg-slate-900/90 border-b border-slate-700/50 glass">
<div class="px-6 py-4 flex items-center justify-between">
<div>
<h2 class="text-xl font-bold" id="pageTitle">Dashboard</h2>
<p class="text-sm text-slate-400" id="pageSubtitle">Overview of your Google Ads performance</p>
</div>
<div class="flex items-center gap-3">
<select id="dateRange" onchange="handleDateChange()" class="px-3 py-2 rounded-lg text-sm bg-slate-800 border border-slate-700 focus:border-blue-500 focus:outline-none">
<option value="today">Today</option>
<option value="yesterday">Yesterday</option>
<option value="last7">Last 7 Days</option>
<option value="last30" selected>Last 30 Days</option>
<option value="last90">Last 90 Days</option>
</select>
<button onclick="refreshData()" class="p-2 rounded-lg bg-slate-800 border border-slate-700 hover:bg-slate-700 transition-colors" title="Refresh">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg>
</button>
</div>
</div>
</header>

<div id="alertContainer" class="px-6 pt-4"></div>

<div class="p-6">
<!-- Dashboard Page -->
<div id="page-dashboard" class="page-content">
<div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6">
<div class="stat-card bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<div class="flex items-center gap-2 mb-2"><div class="p-2 rounded-lg bg-blue-500/20"><svg class="w-4 h-4 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg></div></div>
<p class="text-xs text-slate-400 uppercase">Impressions</p>
<p class="text-xl font-bold" id="kpiImpressions">-</p>
</div>
<div class="stat-card bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<div class="flex items-center gap-2 mb-2"><div class="p-2 rounded-lg bg-purple-500/20"><svg class="w-4 h-4 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"/></svg></div></div>
<p class="text-xs text-slate-400 uppercase">Clicks</p>
<p class="text-xl font-bold" id="kpiClicks">-</p>
</div>
<div class="stat-card bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<div class="flex items-center gap-2 mb-2"><div class="p-2 rounded-lg bg-emerald-500/20"><svg class="w-4 h-4 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg></div></div>
<p class="text-xs text-slate-400 uppercase">Conversions</p>
<p class="text-xl font-bold" id="kpiConversions">-</p>
</div>
<div class="stat-card bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<div class="flex items-center gap-2 mb-2"><div class="p-2 rounded-lg bg-amber-500/20"><svg class="w-4 h-4 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg></div></div>
<p class="text-xs text-slate-400 uppercase">Cost</p>
<p class="text-xl font-bold" id="kpiCost">-</p>
</div>
<div class="stat-card bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<div class="flex items-center gap-2 mb-2"><div class="p-2 rounded-lg bg-rose-500/20"><svg class="w-4 h-4 text-rose-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/></svg></div></div>
<p class="text-xs text-slate-400 uppercase">Revenue</p>
<p class="text-xl font-bold" id="kpiRevenue">-</p>
</div>
<div class="stat-card bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<div class="flex items-center gap-2 mb-2"><div class="p-2 rounded-lg bg-cyan-500/20"><svg class="w-4 h-4 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/></svg></div></div>
<p class="text-xs text-slate-400 uppercase">ROAS</p>
<p class="text-xl font-bold" id="kpiRoas">-</p>
</div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl p-5">
<h3 class="font-semibold mb-4">Performance Trend</h3>
<canvas id="performanceChart" height="130"></canvas>
</div>
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl p-5">
<h3 class="font-semibold mb-4">Device Distribution</h3>
<canvas id="deviceChart" height="130"></canvas>
</div>
</div>

<div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
<button onclick="showPage('ai-assistant')" class="p-4 rounded-xl bg-gradient-to-br from-purple-500/20 to-pink-500/20 border border-purple-500/30 hover:border-purple-500/50 transition-all text-left group">
<svg class="w-8 h-8 text-purple-400 mb-2 group-hover:scale-110 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/></svg>
<h4 class="font-semibold">AI Assistant</h4>
<p class="text-xs text-slate-400 mt-1">Create campaigns with AI</p>
</button>
<button onclick="showPage('research')" class="p-4 rounded-xl bg-gradient-to-br from-blue-500/20 to-cyan-500/20 border border-blue-500/30 hover:border-blue-500/50 transition-all text-left group">
<svg class="w-8 h-8 text-blue-400 mb-2 group-hover:scale-110 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
<h4 class="font-semibold">Competitor Research</h4>
<p class="text-xs text-slate-400 mt-1">Spy on competitor ads</p>
</button>
<button onclick="showPage('keyword-research')" class="p-4 rounded-xl bg-gradient-to-br from-emerald-500/20 to-teal-500/20 border border-emerald-500/30 hover:border-emerald-500/50 transition-all text-left group">
<svg class="w-8 h-8 text-emerald-400 mb-2 group-hover:scale-110 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"/></svg>
<h4 class="font-semibold">Keyword Research</h4>
<p class="text-xs text-slate-400 mt-1">Find profitable keywords</p>
</button>
<button onclick="openModal('createCampaign')" class="p-4 rounded-xl bg-gradient-to-br from-amber-500/20 to-orange-500/20 border border-amber-500/30 hover:border-amber-500/50 transition-all text-left group">
<svg class="w-8 h-8 text-amber-400 mb-2 group-hover:scale-110 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
<h4 class="font-semibold">New Campaign</h4>
<p class="text-xs text-slate-400 mt-1">Create ad campaign</p>
</button>
</div>

<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl overflow-hidden">
<div class="p-4 border-b border-slate-700/50 flex items-center justify-between">
<h3 class="font-semibold">Top Campaigns</h3>
<button onclick="showPage('campaigns')" class="text-sm text-blue-400 hover:text-blue-300">View All â†’</button>
</div>
<div class="overflow-x-auto">
<table class="w-full text-sm">
<thead><tr class="text-xs uppercase text-slate-400 bg-slate-800/80">
<th class="text-left p-4">Campaign</th><th class="text-left p-4">Status</th><th class="text-left p-4">Type</th>
<th class="text-right p-4">Impr</th><th class="text-right p-4">Clicks</th><th class="text-right p-4">Conv</th>
<th class="text-right p-4">Cost</th><th class="text-right p-4">ROAS</th>
</tr></thead>
<tbody id="dashboardCampaigns"></tbody>
</table>
</div>
</div>
</div>

<!-- AI Assistant Page - Enhanced -->
<div id="page-ai-assistant" class="page-content hidden">
<div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-[calc(100vh-180px)]">
<!-- Chat Area -->
<div class="lg:col-span-3 flex flex-col bg-slate-800/60 border border-slate-700/50 rounded-xl overflow-hidden">
<!-- Chat Header -->
<div class="p-4 border-b border-slate-700/50 flex items-center justify-between">
<div class="flex items-center gap-3">
<div class="w-10 h-10 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center shadow-lg">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
</div>
<div>
<h3 class="font-semibold">AI Campaign Assistant</h3>
<p class="text-xs text-slate-400">Powered by Claude AI</p>
</div>
</div>
<div class="flex items-center gap-2">
<span id="aiStatus" class="px-2 py-1 rounded-full text-xs bg-emerald-500/20 text-emerald-400">Ready</span>
<button onclick="clearChat()" class="p-2 rounded-lg hover:bg-slate-700 transition-colors" title="Clear chat">
<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
</button>
</div>
</div>

<!-- Chat Messages -->
<div id="chatMessages" class="flex-1 overflow-y-auto p-4 space-y-4">
<div class="flex gap-3">
<div class="w-8 h-8 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center flex-shrink-0">
<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
</div>
<div class="bg-slate-700/50 rounded-xl rounded-tl-none p-4 max-w-2xl">
<p class="text-sm">ğŸ‘‹ Hello! I'm your AI Campaign Assistant. I can help you:</p>
<ul class="text-sm mt-3 space-y-2 text-slate-300">
<li class="flex items-center gap-2"><span class="text-purple-400">âœ¦</span> Create new Google Ads campaigns with optimized settings</li>
<li class="flex items-center gap-2"><span class="text-purple-400">âœ¦</span> Generate compelling ad copy and headlines</li>
<li class="flex items-center gap-2"><span class="text-purple-400">âœ¦</span> Find profitable keywords for your business</li>
<li class="flex items-center gap-2"><span class="text-purple-400">âœ¦</span> Analyze competitor strategies</li>
<li class="flex items-center gap-2"><span class="text-purple-400">âœ¦</span> Optimize bids and budgets</li>
</ul>
<p class="text-sm mt-3">What would you like to work on today?</p>
</div>
</div>
</div>

<!-- Chat Input -->
<div class="p-4 border-t border-slate-700/50">
<div id="apiKeyWarning" class="hidden mb-3 p-3 rounded-lg bg-amber-500/10 border border-amber-500/30">
<p class="text-sm text-amber-400">âš ï¸ Claude API key not configured. <button onclick="showPage('settings')" class="underline font-medium">Add your API key</button> to enable AI features.</p>
</div>
<div class="flex gap-3">
<input type="text" id="chatInput" placeholder="Ask me to create a campaign, find keywords, write ad copy..." class="chat-input flex-1 px-4 py-3 rounded-xl text-sm bg-slate-700 border border-slate-600 placeholder-slate-500 focus:outline-none focus:border-purple-500 transition-all" onkeypress="if(event.key==='Enter'&&!event.shiftKey)sendChat()">
<button onclick="sendChat()" id="sendBtn" class="px-5 py-3 rounded-xl text-sm font-medium bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 transition-all flex items-center gap-2 disabled:opacity-50">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/></svg>
Send
</button>
</div>
</div>
</div>

<!-- Quick Actions Sidebar -->
<div class="flex flex-col gap-4">
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<h4 class="font-semibold text-sm mb-3">Quick Actions</h4>
<div class="space-y-2">
<button onclick="quickPrompt('Create a search campaign for home internet services in California with $50/day budget')" class="quick-action w-full p-3 rounded-lg bg-purple-500/20 text-left text-sm hover:bg-purple-500/30 transition-all">
<span class="text-purple-400 font-medium">ğŸ“Š Create Campaign</span>
<p class="text-xs text-slate-400 mt-1">Generate full campaign plan</p>
</button>
<button onclick="quickPrompt('Generate 10 keyword ideas for fiber internet services with search volume and CPC estimates')" class="quick-action w-full p-3 rounded-lg bg-emerald-500/20 text-left text-sm hover:bg-emerald-500/30 transition-all">
<span class="text-emerald-400 font-medium">ğŸ”‘ Find Keywords</span>
<p class="text-xs text-slate-400 mt-1">Research profitable keywords</p>
</button>
<button onclick="quickPrompt('Write 5 Google Ads headlines and 3 descriptions for promoting high-speed internet service')" class="quick-action w-full p-3 rounded-lg bg-blue-500/20 text-left text-sm hover:bg-blue-500/30 transition-all">
<span class="text-blue-400 font-medium">âœï¸ Write Ad Copy</span>
<p class="text-xs text-slate-400 mt-1">Generate headlines & descriptions</p>
</button>
<button onclick="quickPrompt('Analyze what keywords and ads spectrum.com might be running and how to compete with them')" class="quick-action w-full p-3 rounded-lg bg-amber-500/20 text-left text-sm hover:bg-amber-500/30 transition-all">
<span class="text-amber-400 font-medium">ğŸ” Analyze Competitor</span>
<p class="text-xs text-slate-400 mt-1">Spy on competitor strategy</p>
</button>
<button onclick="quickPrompt('How can I improve my Quality Score and reduce CPC for my internet service keywords?')" class="quick-action w-full p-3 rounded-lg bg-rose-500/20 text-left text-sm hover:bg-rose-500/30 transition-all">
<span class="text-rose-400 font-medium">âš¡ Optimize Campaigns</span>
<p class="text-xs text-slate-400 mt-1">Get optimization tips</p>
</button>
</div>
</div>

<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl p-4">
<h4 class="font-semibold text-sm mb-3">Example Prompts</h4>
<div class="space-y-2 text-xs">
<button onclick="quickPrompt('Create a Performance Max campaign for cable TV services targeting Texas')" class="w-full text-left p-2 rounded-lg hover:bg-slate-700/50 text-slate-400 hover:text-white transition-colors">"Create a Performance Max campaign..."</button>
<button onclick="quickPrompt('What bid strategy should I use for lead generation campaigns?')" class="w-full text-left p-2 rounded-lg hover:bg-slate-700/50 text-slate-400 hover:text-white transition-colors">"What bid strategy should I use..."</button>
<button onclick="quickPrompt('Write ad copy for a limited time 50% off internet promotion')" class="w-full text-left p-2 rounded-lg hover:bg-slate-700/50 text-slate-400 hover:text-white transition-colors">"Write ad copy for a promotion..."</button>
</div>
</div>
</div>
</div>
</div>

<!-- Campaigns Page -->
<div id="page-campaigns" class="page-content hidden">
<div class="flex items-center justify-between mb-6">
<div class="flex gap-2">
<button class="px-4 py-2 rounded-lg text-sm font-medium bg-blue-500 hover:bg-blue-600 transition-colors" onclick="openModal('createCampaign')">+ New Campaign</button>
</div>
</div>
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl overflow-hidden">
<table class="w-full text-sm">
<thead><tr class="text-xs uppercase text-slate-400 bg-slate-800/80">
<th class="p-4"><input type="checkbox"></th><th class="text-left p-4">Campaign</th><th class="text-left p-4">Status</th><th class="text-left p-4">Type</th>
<th class="text-right p-4">Budget</th><th class="text-right p-4">Impr</th><th class="text-right p-4">Clicks</th><th class="text-right p-4">Conv</th><th class="text-right p-4">Cost</th>
</tr></thead>
<tbody id="campaignsTable"></tbody>
</table>
</div>
</div>

<!-- Keywords Page -->
<div id="page-keywords" class="page-content hidden">
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl overflow-hidden">
<div class="p-4 border-b border-slate-700/50"><h3 class="font-semibold">Keywords Performance</h3></div>
<div class="overflow-x-auto max-h-[600px] overflow-y-auto">
<table class="w-full text-sm">
<thead class="sticky top-0 bg-slate-800"><tr class="text-xs uppercase text-slate-400">
<th class="text-left p-4">Keyword</th><th class="text-left p-4">Match</th><th class="text-center p-4">QS</th>
<th class="text-right p-4">Impr</th><th class="text-right p-4">Clicks</th><th class="text-right p-4">Conv</th><th class="text-right p-4">Cost</th>
</tr></thead>
<tbody id="keywordsTable"></tbody>
</table>
</div>
</div>
</div>

<!-- Ads Page -->
<div id="page-ads" class="page-content hidden">
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="adsContainer"></div>
</div>

<!-- Research Page -->
<div id="page-research" class="page-content hidden">
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl p-5 mb-6">
<h3 class="font-semibold mb-4">Analyze Competitor</h3>
<div class="flex gap-4">
<input type="text" id="competitorUrl" placeholder="Enter competitor domain (e.g., spectrum.com)" class="flex-1 px-4 py-3 rounded-xl text-sm bg-slate-700 border border-slate-600 placeholder-slate-500 focus:outline-none focus:border-blue-500">
<button onclick="analyzeCompetitor()" class="px-6 py-3 rounded-xl text-sm font-medium bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 transition-all">Analyze</button>
</div>
</div>
<div id="competitorResults"></div>
</div>

<!-- Keyword Research Page -->
<div id="page-keyword-research" class="page-content hidden">
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl p-5 mb-6">
<h3 class="font-semibold mb-4">Find Keywords</h3>
<div class="flex gap-4">
<input type="text" id="keywordInput" placeholder="Enter seed keyword" class="flex-1 px-4 py-3 rounded-xl text-sm bg-slate-700 border border-slate-600 placeholder-slate-500 focus:outline-none focus:border-blue-500">
<button onclick="searchKeywords()" class="px-6 py-3 rounded-xl text-sm font-medium bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700 transition-all">Research</button>
</div>
</div>
<div id="keywordResults"></div>
</div>

<!-- Settings Page -->
<div id="page-settings" class="page-content hidden">
<div class="max-w-2xl">
<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl p-6 mb-6">
<div class="flex items-center gap-3 mb-4">
<div class="w-10 h-10 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
</div>
<div>
<h3 class="font-semibold">Claude AI API</h3>
<p class="text-xs text-slate-400">Required for AI Assistant features</p>
</div>
</div>
<div>
<label class="text-sm text-slate-400 block mb-2">Anthropic API Key</label>
<div class="flex gap-2">
<input type="password" id="claudeApiKey" placeholder="sk-ant-api03-..." class="flex-1 px-4 py-2.5 rounded-lg text-sm bg-slate-700 border border-slate-600 focus:outline-none focus:border-purple-500">
<button onclick="saveClaudeKey()" class="px-5 py-2.5 rounded-lg text-sm font-medium bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 transition-all">Save</button>
</div>
<p class="text-xs text-slate-500 mt-2">Get your API key from <a href="https://console.anthropic.com" target="_blank" class="text-purple-400 hover:underline">console.anthropic.com</a></p>
</div>
</div>

<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl p-6">
<h3 class="font-semibold mb-4">Google Ads API</h3>
<div class="space-y-3">
<div>
<label class="text-sm text-slate-400 block mb-1">Developer Token</label>
<input type="password" value="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" class="w-full px-4 py-2 rounded-lg text-sm bg-slate-700/50 border border-slate-600" readonly>
</div>
<div>
<label class="text-sm text-slate-400 block mb-1">Customer ID</label>
<input type="text" id="settingsCustomerId" value="" class="w-full px-4 py-2 rounded-lg text-sm bg-slate-700/50 border border-slate-600" readonly>
</div>
<p class="text-xs text-amber-400">âš ï¸ API Status: Test Account (waiting for Basic Access)</p>
</div>
</div>
</div>
</div>

</div>
</main>
</div>
</div>

<!-- Modals -->
<div id="modal-createCampaign" class="modal">
<div class="bg-slate-800 border border-slate-700 rounded-2xl p-6 max-w-lg w-full mx-4">
<div class="flex items-center justify-between mb-4">
<h3 class="text-lg font-semibold">Create New Campaign</h3>
<button onclick="closeModal('createCampaign')" class="p-1 rounded-lg hover:bg-slate-700"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></button>
</div>
<div class="space-y-4">
<div><label class="text-sm text-slate-400 block mb-2">Campaign Name</label><input type="text" placeholder="e.g., Home Internet - California" class="w-full px-4 py-2 rounded-lg text-sm bg-slate-700 border border-slate-600 focus:outline-none focus:border-blue-500"></div>
<div><label class="text-sm text-slate-400 block mb-2">Campaign Type</label><select class="w-full px-4 py-2 rounded-lg text-sm bg-slate-700 border border-slate-600"><option>Search</option><option>Display</option><option>Video</option><option>Performance Max</option></select></div>
<div><label class="text-sm text-slate-400 block mb-2">Daily Budget ($)</label><input type="number" placeholder="50" class="w-full px-4 py-2 rounded-lg text-sm bg-slate-700 border border-slate-600 focus:outline-none focus:border-blue-500"></div>
<div class="flex gap-3 mt-6">
<button onclick="closeModal('createCampaign')" class="flex-1 py-2 rounded-lg text-sm font-medium bg-slate-700 hover:bg-slate-600">Cancel</button>
<button onclick="closeModal('createCampaign');showPage('ai-assistant');quickPrompt('Help me create a new Google Ads campaign')" class="flex-1 py-2 rounded-lg text-sm font-medium bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700">Create with AI</button>
</div>
</div>
</div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let currentPage = 'dashboard';
let performanceChart = null;
let deviceChart = null;
let chatHistory = [];
let isTyping = false;

// API Key Management
const getApiKey = (name) => localStorage.getItem(`apiKey_${name}`) || '';
const setApiKey = (name, value) => localStorage.setItem(`apiKey_${name}`, value);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FORMATTING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const fmt = n => (n===null||n===undefined||isNaN(n))?'-':n>=1e6?(n/1e6).toFixed(1)+'M':n>=1e3?(n/1e3).toFixed(1)+'K':n.toLocaleString();
const fmtC = n => (n===null||n===undefined||isNaN(n))?'-':'$'+n.toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2});
const statusBadge = s => {const colors = {'ENABLED':'bg-emerald-500/20 text-emerald-400','PAUSED':'bg-amber-500/20 text-amber-400'};return `<span class="px-2 py-0.5 rounded-full text-xs font-medium ${colors[s]||'bg-slate-500/20 text-slate-400'}">${s==='ENABLED'?'Active':s}</span>`;};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showPage(page) {
currentPage = page;
document.querySelectorAll('.page-content').forEach(p => p.classList.add('hidden'));
document.getElementById('page-'+page)?.classList.remove('hidden');
document.querySelectorAll('.nav-item').forEach(n => {n.classList.remove('active');n.classList.add('text-slate-400');});
document.querySelector(`[data-page="${page}"]`)?.classList.add('active');
document.querySelector(`[data-page="${page}"]`)?.classList.remove('text-slate-400');
const titles = {dashboard:['Dashboard','Overview of your Google Ads performance'],campaigns:['Campaigns','Manage your campaigns'],keywords:['Keywords','View keyword performance'],ads:['Ads','Your ad creatives'],'ai-assistant':['AI Assistant','Create and optimize campaigns with AI'],research:['Competitor Research','Analyze competitors'],'keyword-research':['Keyword Research','Find profitable keywords'],settings:['Settings','Configure API keys']};
document.getElementById('pageTitle').textContent = titles[page]?.[0]||page;
document.getElementById('pageSubtitle').textContent = titles[page]?.[1]||'';
loadPageData(page);
}

function loadPageData(page) {
if(page==='dashboard')loadDashboard();
else if(page==='campaigns')loadCampaigns();
else if(page==='keywords')loadKeywords();
else if(page==='ads')loadAds();
else if(page==='ai-assistant')checkAiStatus();
else if(page==='settings')loadSettings();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// API CALLS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function fetchAPI(endpoint) {
const range = document.getElementById('dateRange').value;
try {const res = await fetch(`/api/${endpoint}?range=${range}`);return await res.json();} catch(e) {return {success:false,data:null};}
}

async function checkAuth() {
try {const res = await fetch('/auth/status');const data = await res.json();
if(data.authenticated){document.getElementById('userName').textContent=data.user?.name||'User';document.getElementById('userEmail').textContent=data.user?.email||'';if(data.user?.picture)document.getElementById('userPicture').src=data.user.picture;loadDashboard();}
else{window.location.href='/auth/login';}}catch(e){}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DASHBOARD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function loadDashboard() {
const data = await fetchAPI('dashboard');
if(data.success&&data.data){const s=data.data.summary;document.getElementById('kpiImpressions').textContent=fmt(s.impressions);document.getElementById('kpiClicks').textContent=fmt(s.clicks);document.getElementById('kpiConversions').textContent=fmt(s.conversions);document.getElementById('kpiCost').textContent=fmtC(s.cost);document.getElementById('kpiRevenue').textContent=fmtC(s.revenue);document.getElementById('kpiRoas').textContent=s.roas?s.roas.toFixed(2)+'x':'-';renderDashboardCampaigns(data.data.campaigns);renderPerformanceChart(s.daily);renderDeviceChart(data.data.devices);}
}

function renderDashboardCampaigns(campaigns) {
const tbody=document.getElementById('dashboardCampaigns');
if(!campaigns?.length){tbody.innerHTML='<tr><td colspan="8" class="p-8 text-center text-slate-400">No campaign data available</td></tr>';return;}
tbody.innerHTML=campaigns.slice(0,10).map(c=>`<tr class="table-row border-t border-slate-700/50"><td class="p-4 font-medium">${c.name}</td><td class="p-4">${statusBadge(c.status)}</td><td class="p-4 text-slate-400">${c.type}</td><td class="p-4 text-right">${fmt(c.impressions)}</td><td class="p-4 text-right">${fmt(c.clicks)}</td><td class="p-4 text-right font-medium">${fmt(c.conversions)}</td><td class="p-4 text-right">${fmtC(c.cost)}</td><td class="p-4 text-right font-medium">${c.cost>0?(c.revenue/c.cost).toFixed(2)+'x':'-'}</td></tr>`).join('');
}

function renderPerformanceChart(daily) {
const ctx=document.getElementById('performanceChart')?.getContext('2d');if(!ctx)return;if(performanceChart)performanceChart.destroy();
performanceChart=new Chart(ctx,{type:'line',data:{labels:daily?.map(d=>d.date).reverse()||[],datasets:[{label:'Conversions',data:daily?.map(d=>d.conversions).reverse()||[],borderColor:'#3b82f6',backgroundColor:'rgba(59,130,246,0.1)',fill:true,tension:0.4}]},options:{responsive:true,plugins:{legend:{display:false}},scales:{x:{grid:{color:'#334155'},ticks:{color:'#64748b'}},y:{grid:{color:'#334155'},ticks:{color:'#64748b'}}}}});
}

function renderDeviceChart(devices) {
const ctx=document.getElementById('deviceChart')?.getContext('2d');if(!ctx)return;if(deviceChart)deviceChart.destroy();
deviceChart=new Chart(ctx,{type:'doughnut',data:{labels:devices?.map(d=>d.device)||[],datasets:[{data:devices?.map(d=>d.impressions)||[],backgroundColor:['#3b82f6','#8b5cf6','#ec4899','#f97316'],borderWidth:0}]},options:{responsive:true,plugins:{legend:{position:'right',labels:{color:'#94a3b8'}}},cutout:'60%'}});
}

async function loadCampaigns() {
const data=await fetchAPI('campaigns');const tbody=document.getElementById('campaignsTable');
if(!data.data?.length){tbody.innerHTML='<tr><td colspan="9" class="p-8 text-center text-slate-400">No campaigns found</td></tr>';return;}
tbody.innerHTML=data.data.map(c=>`<tr class="table-row border-t border-slate-700/50"><td class="p-4"><input type="checkbox"></td><td class="p-4 font-medium">${c.name}</td><td class="p-4">${statusBadge(c.status)}</td><td class="p-4 text-slate-400">${c.type}</td><td class="p-4 text-right">${fmtC(c.budget)}/d</td><td class="p-4 text-right">${fmt(c.impressions)}</td><td class="p-4 text-right">${fmt(c.clicks)}</td><td class="p-4 text-right">${fmt(c.conversions)}</td><td class="p-4 text-right">${fmtC(c.cost)}</td></tr>`).join('');
}

async function loadKeywords() {
const data=await fetchAPI('keywords');const tbody=document.getElementById('keywordsTable');
if(!data.data?.length){tbody.innerHTML='<tr><td colspan="7" class="p-8 text-center text-slate-400">No keywords found</td></tr>';return;}
tbody.innerHTML=data.data.map(k=>`<tr class="table-row border-t border-slate-700/50"><td class="p-4 font-medium">${k.keyword}</td><td class="p-4"><span class="px-2 py-0.5 rounded text-xs ${k.matchType==='Exact'?'bg-blue-500/20 text-blue-400':'bg-amber-500/20 text-amber-400'}">${k.matchType}</span></td><td class="p-4 text-center">${k.qualityScore?`<span class="font-bold ${k.qualityScore>=8?'text-emerald-400':'text-amber-400'}">${k.qualityScore}/10</span>`:'-'}</td><td class="p-4 text-right">${fmt(k.impressions)}</td><td class="p-4 text-right">${fmt(k.clicks)}</td><td class="p-4 text-right">${fmt(k.conversions)}</td><td class="p-4 text-right">${fmtC(k.cost)}</td></tr>`).join('');
}

async function loadAds() {
const data=await fetchAPI('ads');const container=document.getElementById('adsContainer');
if(!data.data?.length){container.innerHTML='<p class="col-span-3 text-center text-slate-400 py-8">No ads found</p>';return;}
container.innerHTML=data.data.map(a=>`<div class="bg-slate-800/60 border border-slate-700/50 rounded-xl p-4"><div class="flex items-center justify-between mb-2"><span class="px-2 py-0.5 rounded text-xs bg-blue-500/20 text-blue-400">${a.type}</span>${statusBadge(a.status)}</div><div class="p-3 rounded-lg bg-slate-700/50 mb-3"><p class="text-blue-400 text-sm font-medium">${a.headlines?.[0]||'No headline'}</p><p class="text-xs text-slate-400 mt-1">${a.descriptions?.[0]||''}</p></div><div class="grid grid-cols-4 gap-2 text-center"><div><p class="text-xs text-slate-500">Impr</p><p class="text-sm font-bold">${fmt(a.impressions)}</p></div><div><p class="text-xs text-slate-500">Clicks</p><p class="text-sm font-bold">${fmt(a.clicks)}</p></div><div><p class="text-xs text-slate-500">Conv</p><p class="text-sm font-bold">${fmt(a.conversions)}</p></div><div><p class="text-xs text-slate-500">Cost</p><p class="text-sm font-bold">${fmtC(a.cost)}</p></div></div></div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AI CHAT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function checkAiStatus() {
const apiKey = getApiKey('claude');
const warning = document.getElementById('apiKeyWarning');
const status = document.getElementById('aiStatus');
if(!apiKey) {warning.classList.remove('hidden');status.textContent='Not configured';status.className='px-2 py-1 rounded-full text-xs bg-amber-500/20 text-amber-400';}
else {warning.classList.add('hidden');status.textContent='Ready';status.className='px-2 py-1 rounded-full text-xs bg-emerald-500/20 text-emerald-400';}
}

function quickPrompt(text) {
document.getElementById('chatInput').value = text;
sendChat();
}

async function sendChat() {
const input = document.getElementById('chatInput');
const message = input.value.trim();
if(!message || isTyping) return;

const apiKey = getApiKey('claude');
if(!apiKey) {
showAlert('Please add your Claude API key in Settings first', 'error');
return;
}

// Add user message to UI
addMessageToChat('user', message);
input.value = '';
isTyping = true;
document.getElementById('sendBtn').disabled = true;

// Show typing indicator
const typingId = addTypingIndicator();

try {
const res = await fetch('/ai/chat', {
method: 'POST',
headers: {'Content-Type': 'application/json'},
body: JSON.stringify({ message, apiKey })
});

const data = await res.json();
removeTypingIndicator(typingId);

if(data.success) {
addMessageToChat('assistant', data.message);
} else {
addMessageToChat('assistant', 'âŒ Error: ' + (data.error || 'Failed to get response'));
}
} catch(e) {
removeTypingIndicator(typingId);
addMessageToChat('assistant', 'âŒ Error: Could not connect to AI service');
}

isTyping = false;
document.getElementById('sendBtn').disabled = false;
}

function addMessageToChat(role, content) {
const container = document.getElementById('chatMessages');
const isUser = role === 'user';

// Parse markdown for assistant messages
const formattedContent = isUser ? escapeHtml(content) : marked.parse(content);

const html = `
<div class="flex gap-3 ${isUser ? 'justify-end' : ''}">
${!isUser ? `<div class="w-8 h-8 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center flex-shrink-0">
<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
</div>` : ''}
<div class="${isUser ? 'bg-blue-500/20 rounded-xl rounded-tr-none' : 'bg-slate-700/50 rounded-xl rounded-tl-none'} p-4 max-w-2xl">
<div class="${isUser ? 'text-sm' : 'ai-message text-sm'}">${formattedContent}</div>
</div>
${isUser ? `<div class="w-8 h-8 rounded-lg bg-slate-700 flex items-center justify-center flex-shrink-0">
<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
</div>` : ''}
</div>
`;
container.insertAdjacentHTML('beforeend', html);
container.scrollTop = container.scrollHeight;
}

function addTypingIndicator() {
const container = document.getElementById('chatMessages');
const id = 'typing-' + Date.now();
container.insertAdjacentHTML('beforeend', `
<div id="${id}" class="flex gap-3">
<div class="w-8 h-8 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center flex-shrink-0">
<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
</div>
<div class="bg-slate-700/50 rounded-xl rounded-tl-none p-4">
<div class="typing-indicator flex gap-1">
<span class="w-2 h-2 bg-slate-400 rounded-full"></span>
<span class="w-2 h-2 bg-slate-400 rounded-full"></span>
<span class="w-2 h-2 bg-slate-400 rounded-full"></span>
</div>
</div>
</div>
`);
container.scrollTop = container.scrollHeight;
return id;
}

function removeTypingIndicator(id) {
document.getElementById(id)?.remove();
}

function clearChat() {
document.getElementById('chatMessages').innerHTML = `
<div class="flex gap-3">
<div class="w-8 h-8 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center flex-shrink-0">
<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
</div>
<div class="bg-slate-700/50 rounded-xl rounded-tl-none p-4 max-w-2xl">
<p class="text-sm">Chat cleared. How can I help you?</p>
</div>
</div>
`;
fetch('/ai/chat/clear', {method: 'POST'});
}

function escapeHtml(text) {
const div = document.createElement('div');
div.textContent = text;
return div.innerHTML;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SETTINGS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function loadSettings() {
document.getElementById('claudeApiKey').value = getApiKey('claude');
}

function saveClaudeKey() {
const key = document.getElementById('claudeApiKey').value.trim();
if(key) {setApiKey('claude', key);showAlert('Claude API key saved!', 'success');checkAiStatus();}
else showAlert('Please enter an API key', 'error');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UTILITIES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showAlert(msg, type='info') {
const colors = {success:'bg-emerald-500/20 border-emerald-500/50 text-emerald-400',error:'bg-rose-500/20 border-rose-500/50 text-rose-400',info:'bg-blue-500/20 border-blue-500/50 text-blue-400'};
document.getElementById('alertContainer').innerHTML = `<div class="p-4 rounded-xl border ${colors[type]} mb-4">${msg}</div>`;
setTimeout(() => document.getElementById('alertContainer').innerHTML = '', 5000);
}

function openModal(name) {document.getElementById('modal-'+name)?.classList.add('active');}
function closeModal(name) {document.getElementById('modal-'+name)?.classList.remove('active');}
function switchAccount(id) {showAlert('Account switched to '+id, 'info');}
function handleDateChange() {loadPageData(currentPage);}
function refreshData() {loadPageData(currentPage);}

function analyzeCompetitor() {
const domain = document.getElementById('competitorUrl').value;
if(domain) {showPage('ai-assistant');quickPrompt(`Analyze the competitor ${domain} - what keywords are they likely targeting, what ads are they running, and how can I compete with them?`);}
}

function searchKeywords() {
const keyword = document.getElementById('keywordInput').value;
if(keyword) {showPage('ai-assistant');quickPrompt(`Find 15 keyword ideas for "${keyword}" with estimated search volume, CPC, competition level, and search intent`);}
}

// Init
document.addEventListener('DOMContentLoaded', checkAuth);
</script>
</body>
</html>
